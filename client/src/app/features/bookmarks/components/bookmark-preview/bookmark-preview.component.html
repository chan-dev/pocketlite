<div class="bookmark-preview">
  <div class="border-b">
    <article class="max-w-xs">
      <header>
        <h1>
          <a
            class="block truncate text-left antialiased"
            [attr.href]="bookmark.url"
          >
            <div
              *ngIf="bookmark.image"
              class="md:h-48 overflow-hidden w-full h-64 rounded bg-cover bg-center"
              aria-hidden="true"
              [ngStyle]="{ 'background-image': 'url(' + bookmark.image + ')' }"
            ></div>
            <!-- TODO: convert to component -->
            <div
              *ngIf="!bookmark.image"
              class="md:h-48 overflow-hidden w-full h-64 rounded object-fit object-center"
              aria-hidden="true"
            >
              <app-text-img [text]="bookmark.title | slice: 0:1"></app-text-img>
            </div>

            <span class="block truncate text-xl mt-2 font-semibold">
              {{ bookmark.title }}
            </span>
          </a>
        </h1>
      </header>

      <a
        class="block mb-3 font-normal"
        [attr.aria-label]="bookmark.domain"
        [attr.href]="bookmark.url"
      >
        <cite class="not-italic text-gray-700 text-md">
          {{ bookmark.domain }}
        </cite>
      </a>
      <div class="text-md text-gray-700" style="min-height: 4rem">
        <p class="truncate-2-lines">{{ bookmark.description }}</p>
      </div>
    </article>
    <!-- action menu -->
    <div class="action-buttons flex justify-between text-gray-700 my-4">
      <div class="status-icons flex">
        <span
          class="flex rounded mx-1 bg-yellow-500 text-white"
          *ngIf="favorited"
        >
          <span class="cdk-visually-hidden">This bookmark is favorited</span>
          <mat-icon>star_rate</mat-icon>
        </span>
        <span
          class="flex rounded mx-1 bg-blue-600 text-white"
          *ngIf="bookmark.contentInMarkdown.length"
        >
          <span class="cdk-visually-hidden"
            >This bookmark will be redirected to the original webpage</span
          >
          <mat-icon>language</mat-icon>
        </span>
      </div>

      <button
        class="flex ml-auto"
        [matMenuTriggerFor]="menu"
        aria-label="Bookmark preview menu"
      >
        <mat-icon>more_horiz</mat-icon>
      </button>
      <mat-menu
        #menu="matMenu"
        xPosition="before"
        yPosition="above"
        class="p-0 rounded-none"
      >
        <ul class="flex flex-col justify-center w-full h-full">
          <button
            class="hover:bg-gray-200 hover:text-green-800 flex items-center justify-start p-2"
          >
            <mat-icon class="mr-2">share</mat-icon>
            Share
          </button>
          <button
            *ngIf="!bookmark.deleted"
            class="hover:bg-gray-200 hover:text-green-800 flex items-center justify-start p-2"
            (click)="archiveBookmark(bookmark.id)"
          >
            <mat-icon class="mr-2">archive</mat-icon>
            Archive
          </button>
          <button
            *ngIf="bookmark.deleted"
            class="hover:bg-gray-200 hover:text-green-800 flex items-center justify-start p-2"
            (click)="restoreBookmark(bookmark.id)"
          >
            <mat-icon class="mr-2">add</mat-icon>
            Re-add
          </button>
          <button
            class="hover:bg-gray-200 hover:text-green-800 flex items-center justify-start p-2"
            (click)="deleteBookmark(bookmark.id)"
          >
            <mat-icon class="mr-2">delete</mat-icon>
            Delete
          </button>
          <button
            class="hover:bg-gray-300 hover:text-green-800 flex items-center justify-start p-2"
            (click)="toggleFavoriteBookmark(bookmark)"
          >
            <!-- TODO: highlight the star icon -->
            <mat-icon class="mr-2" [ngClass]="{ 'text-yellow-500': favorited }"
              >star</mat-icon
            >
            Favorite
          </button>
          <button
            class="hover:bg-gray-300 hover:text-green-800 flex items-center justify-start p-2"
            (click)="openTagsModal()"
          >
            <mat-icon class="mr-2">local_offer</mat-icon>
            Tags
          </button>
        </ul>
      </mat-menu>
    </div>
  </div>
</div>
